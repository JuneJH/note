# 监控平台

涵盖SDK(适配Vanilla、React、Vue)、数据服务后端(Nestjs)以及数据可视化平台(基于React和Nestjs)。项目的核心目标是帮助开发团队对应用进行实时性能监控和异常捕获，支持迅速响应和修复问题，以提高产品的稳定性和用户体验。

明确需求

1. 前端监控需求分析与方案评审: 前端异常、性能监控、监控需求的重要性
2. 项目架构设计分析：掌握项目架构的设计原则，能够根据监控需求对项目进行架构规划，基于monorepo设计全栈项目
3. 理解Performance指标的基本概念，掌握web vital指标，能够在项目中应用这些指标对性能进行基础监控
4. 性能与异常指标分类与采集：掌握性能指标（加载时间、交互响应时间）和异常指标（错误率、异常次数）的分类
5. 熟悉性能和异常数据采集的高级方法，能够设计通用数据协议，封装上报数据
6. 能够对Performance指标优化与高级分析

1. ## 性能监控

1. 关键指标
   1. CLS（Cumulative Layout Shift）： 页面布局稳定性
   2. LCP（Largest Contentful Palnt）： 最大内容绘制时间
   3. TTFB（Time to First Byte）：首字节时间
   4. INP（Interaction to Next Paint）： 交互延迟
   5. FID（First Input Delay）：首次输入延迟
2. 监控工具
   1. Web Vitals： 采集核心Web性能指标
   2. PerformanceObserver：监控性能事件
   3. Performance API：手动标记和测量性能

1. ## 异常监控

1. 异常捕获
   1. 全局错误捕获（window.onerror/捕获Javascript错误）
   2. 未处理Promise捕获（使用window.onunhandledrejection捕获未处理的Promise异常）

```TypeScript
window.onerror = () => {
     // 捕获错误进行收集
}

window.onunhandledrejection = event => {
     // 捕获错误进行收集
}
```

1. 错误报告
   1. 错误级别：Info、Warning、Error、Fatal
   2. 错误上下文：URL、堆栈信息、用户操作轨迹
2. 日志记录（本地日志与远程日志系统对接）

1. ## 用户行为监控（埋点监控）

1. 埋点类型
   1. 手动埋点：在关键操作中手动记录（按钮点击、表单提交）
   2. 自动埋点：自动捕获页面访问、点击、滚动等用户操作
2. 数据采集
   1. DOM事件监控：通过代理addEventListener捕获点击、键盘输入等操作
   2. XHR/Fetch请求监控：通过代理XMLHttpRequest、重写fetch捕获请求信息
   3. 用户行为轨迹：捕获用户的页面跳转、滚动、点击轨迹
3. 数据上报
   1. 实时上报与批量上报
   2. 上报频率控制和队列管理

1. ## 平台集成

- Sentry：前端性能与异常监控
- Google Analytics：用户行为与转化率分析
- LogRocket: 结合日志和用户行为监控
- Grafana + Loki: 前端与后端的统一监控

1. ## 性能优化建设/异常处理/埋点设计

- 图片优化
- 代码分割
- 懒加载
- 错误捕获与回退机制
- 异常用户友好提示
- 埋点的合理化与精细化