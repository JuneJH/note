# Dvajs使用

> 阿里巴巴团队集合redux、redux-saga等数据处理方案的一套框架
>
> 命名来自游戏守望先锋

# 1. dva APi

> dvajs 默认导出一个函数,通过该函数可以得到一个dva对象

- 1. router: 传入一个函数,返回一个React节点
- 2. modle: 定义redux/redux-saga:state、reduce、effect等
- 3. start: 启动dva程序,该函数需要传递一个css选择器用于确定容器

## 1.router

```js

    const app = dva();
    //注册渲染根组件
    app.router(App);
    // 或者使用
    app.router(()=><App/>)

```

## 2. modle

```js

    // 计数器案例
    export default {
        namespace:"counter",
        state:0,
        reducers:{
            increase(state){
                return state + 1;
            },
            decrease(state){
                return state - 1;
            }
        },
        //处理异步
        effects:{
            *asyncIncrease(action,{call,put}){
                yield call(delay,2000);
                yield put({type:"increase"})
                
            },
            *asyncDecrease(action,{call,put}){
                yield call(delay,2000);
                yield put({type:"decrease"})
            }
        },
        // 初始化时执行的函数对象集合
        subscriptions:{
            onSubscription(obj){
                console.log(obj)

            }
        }
    }


    function delay(duration){
        return new Promise(resove=>{
            setTimeout(()=>{
                resove()
            },duration)
        })
    }

```

## 3. start 

```js

    //开启项目
    app.start("#root");

```

## 4. dva() 配置项

- 1. history
- 2. initialState
- 3. onError
- 4. onAction
- 5. onStateChange
- 6. onReducer
- 7. onEffect
- 8. extraReducers
- 9. extraEnhancers